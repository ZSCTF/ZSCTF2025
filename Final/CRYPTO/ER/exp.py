from Crypto.Util.number import *

proof.arithmetic(False)

n = 1329409835277518109271478076758698620457781442553056683138607596729277918971297019275813367776592352290664833746956015239042147240530814891282822476028313059445165915147337154765855025228760185571151606973614666013887257973432321224156579598447232659732143648436512252410350971036793653482028476918412157605000672875387785078087808157304647185175674004664581877588155634188993450015991336302398972006664048735499766133154279220935313795070385662504186185687034021
xx, yy = (250075225204182064893779783818256097196128291434371501466702043747553880094254663950677520871729827970226918841685530226467267351077471264536560114495054611541709075395975565897941970082970603405035798408513355397403275182498318652120800776377339491306969253669367733685818653340396116462819583939424090227064818364884140710618769097071670101489468210657052446949077439869135177441899858228705561537212117306791134063539983038615499619634425064423565317942187724, 884828686375979939860725859750166531961255304914662883107369096416341724543533546838657527437621565165501260121493651287527103553578923977605144900279610977168733452583262759099951779482832670488376745537662777474101874221588013739351254911749904363148714242378432805461764332962749631472968049496883914622177580346400316845276937484000705133014754405520453736071152153385737709928260652191209250848313793571244918597651448010427035564095016173064225489195794123)

e = 65537

r = ZZ((yy ^ 2 - xx ^ 3) % n)
P = PolynomialRing(Zmod(n), "q")
q = P.gen()
f = r - q
q = ZZ(f.monic().small_roots(X=2 ^ 512, epsilon=0.8, beta=0.66)[0])
p = n // q
assert p * q == n

print((log(p) / log(n)).n())

E = EllipticCurve(Zmod(n), [p, q])

phi = E.change_ring(GF(p)).order() * E.change_ring(GF(q)).order()
d = inverse_mod(e, phi)
x, y = (d * E(xx, yy)).xy()
print(long_to_bytes(ZZ(x)))

# ZSCTF{********asdasdwqeqwxzczxcdiaojioejijweioqueiwqojkcsdvsdves******}